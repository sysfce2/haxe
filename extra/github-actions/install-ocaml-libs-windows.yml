- name: Install OCaml libraries
  uses: nick-fields/retry@v3
  with:
    timeout_minutes: 10
    max_attempts: 10
    retry_on: timeout
    shell: pwsh
    command: |
      Set-PSDebug -Trace 1
      # stop after any command returns an error
      $PSNativeCommandUseErrorActionPreference = $true
      $ErrorActionPreference = 'Stop'
      # see: https://github.com/aantron/luv/issues/162
      $env:PATH="${env:CYG_ROOT}\bin;${env:CYG_ROOT}\usr\x86_64-w64-mingw32\bin;${env:PATH}"
      opam install haxe --deps-only
      opam list
